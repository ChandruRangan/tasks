<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TO DO LIST</title>
</head>
<body>
    <form action="/insert" method="POST">
       <div class="div">
         <h2>TO DO List</h2>
          <input id="entry" name="name" type="text">
           <button type="submit" id="insert">Add</button>
       <div class="to_do" id="todocontain">
    </div>
    </div>
    </form>
    <div>
        <table>
          <thead>
          </thead>
            <h1>Tasks to do</h1>
            <% for(var i = 0; i <data.length; i++){ %>
             <% if(data[i].status == 0){%>
                <li class="list-group-item">
              <input type="checkbox" name="todo" value="<%= data[i].id%>" onclick='completedTask(event,"<%= data[i].id%>")'/> <%= data[i].task%></li>
              <%} %>
              <%} %>
            <h2>Completed List</h2>
              <% for(var i = 0; i <data.length; i++){ %>
                <% if(data[i].status == 1){%>
                  <li class="list-group-item">
                <input type="checkbox" name="done" value="<%= data[i].id%>" onclick='completedTask(event,"<%= data[i].id%>")'/>
                 <%= data[i].task%></li>
                <%} %>
                <%} %>
          </table>
        </div>
        <script>
          function completedTask(event, id){
          const{name} = event.target;
          fetch("/completedTaskDone", {method: "PUT",
          headers: {
          "Content-Type": "application/json"
          },
          body: JSON.stringify({name,id})
          }).then(response => response.json()).then(status=> {
            window.location.reload()
          }).catch(err => console.log(err))
          }
          </script>
</body>
</html>
