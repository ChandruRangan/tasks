<html>
<head>
    <title>INSERT</title>
    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
  </head>
  <body>
      <div class="container mt-5">
          <h3>Products</h3>
          <form autocomplete="off">
            <div class="form-group">
              <input id="pname" type="text" class="form-control" placeholder="Enter Product Name" name="pname">
              </div>
              <div class="form-group">
                <select name="catid" id="cat" class="form-control">
                  <option value="">Select Category</option>
                  <%for(var i=0 ;i<elements.length; i++) { %>
                    <option value="<%=elements[i].category_id%>"><%=elements[i].category_name%></option>
                    <%}%>
                  </select>
                </div>
                <div class="form-group">
                  <input id="pprice" type="text" class="form-control" placeholder="Enter Price" name="price">
                </div>
                  <a onclick="insert()" class="btn btn-primary">Submit</a>
                  <a href="/" class="px-5 btn  btn-outline-primary">View</a>
              </div>
            </form>
          </div>
          
            
        </div>
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
        <script>
            function insert(){
                console.log("hi")
                let price=document.getElementById("pprice").value;
                let pname=document.getElementById("pname").value;
                let ct=document.getElementById("cat");
                let cat=ct.options[ct.selectedIndex].value;
                console.log(cat);
                
         
        //   var request= new XMLHttpRequest();
        //   request.open("POST", "/products");
        //   request.onreadystatechange=function(){
        //     if(this.readyState === 4 && this.status === 200) {
              
        //       console.log(this.responseText);
        //     }
        //   }
          $.ajax({
            type: "POST",
            url: "/products",
            dataType: "json",
            data: {
                product_name:pname,
                price:price,
                category_id:cat
            },
            success: function (data) {
               alert('Success');

            },
            error: function () {
             alert('Error');
            }
        });
          
            }
        </script>
  </body>
  </html>